---
import PublicImage from '../PublicImage.astro';

interface Props {
  src: string;
  alt: string;
  caption?: string;
  width?: number;
  height?: number;
  class?: string;
}

const { 
  src, 
  alt, 
  caption, 
  width = 1200, 
  height = Math.round(width * (9/16)), // Default to 16:9 aspect ratio
  class: className = '' 
} = Astro.props;

// Define responsive sizes for markdown images
const sizes = "(min-width: 1280px) 740px, (min-width: 768px) 672px, calc(100vw - 2rem)";
---

<figure class={`my-8 ${className}`}>
  <div class="overflow-hidden rounded-lg">
    <PublicImage
      src={src}
      alt={alt}
      width={width}
      height={height}
      class="w-full h-auto"
      loading="lazy"
      decoding="async"
      sizes={sizes}
      format="webp"
      quality={80}
    />
  </div>
  
  {caption && (
    <figcaption class="mt-2 text-sm text-center text-gray-500">
      {caption}
    </figcaption>
  )}
</figure>
