---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostList from '../components/PostList.astro';
import { getCollection } from 'astro:content';

// Get all blog posts and sort them by date
const allPosts = await getCollection('posts');
const sortedPosts = allPosts.sort((a, b) => {
  return new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf();
});

// Show up to 7 posts on the frontpage
const posts = sortedPosts.slice(0, 7).map(post => ({
  ...post,
  url: `/posts/${post.slug}`,
  frontmatter: post.data
}));
---

<BaseLayout title="Welcome">
    <section class="text-center py-[8vh]" transition:animate="slide">
      <h1 class="text-7xl mb-8 font-bold">Welcome to Brook</h1>
      <p class="text-2xl text-muted-foreground max-w-3xl mx-auto mb-14">
        A minimalist blog template for developers and writers focusing on clean typography and distraction-free
        reading experience.
      </p>
      <a href="/about" class="cta-button">
        Discover More
      </a>
    </section>

    <section>
      <PostList posts={posts} showImages={false} showExcerpt={false} showSeparators={true} showTags={false}/>

      <div class="text-center mt-24">
        <a href="/journal" class="text-lg font-medium hover:underline focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 py-2 px-4 rounded-md inline-block">
          View All Posts <span aria-hidden="true">â†’</span>
        </a>
      </div>
    </section>
</BaseLayout>
